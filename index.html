<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="dark light" />
  <meta name="theme-color" content="#111827" />
  <title>TVL Rental – Uitleenformulier & akkoord</title>

  <!-- Favicon (voorkomt 404) -->
  <link rel="icon" href="data:," />

  <!-- Styles -->
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">

  <!-- Hints voor snellere loads -->
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin />
  <link rel="dns-prefetch" href="//cdn.jsdelivr.net" />
  <link rel="dns-prefetch" href="//cdnjs.cloudflare.com" />

  <!-- Libs (volgorde is belangrijk) -->
  <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>

  <script defer src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/jspdf-autotable@3.8.4/dist/jspdf.plugin.autotable.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/signature_pad@4.2.0/dist/signature_pad.umd.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <!-- Jouw script als laatste (cache-busting met v=) -->
<script defer src="script.js"></script>
</head>

<body class="locked">
  <noscript>Je hebt JavaScript nodig om dit formulier te gebruiken.</noscript>

  <!-- Gate / naamcontrole -->
  <div id="gate" class="gate" role="dialog" aria-modal="true" aria-labelledby="gate-title">
    <div class="gate-card">
      <h2 id="gate-title">Controle</h2>
      <p>Vul je naam in om de overdracht te openen.</p>

      <label for="gateName">Naam</label>
      <input
        type="text"
        id="gateName"
        placeholder="Voor- en achternaam"
        autocomplete="name"
        enterkeyhint="go"
        inputmode="text"
      />

      <button type="button" id="gateBtn" class="primary">Doorgaan</button>
      <p id="gateErr" class="gate-err hidden" role="alert">Naam klopt niet. Probeer opnieuw.</p>
    </div>
  </div>

  <!-- ==================== FORMULIER ==================== -->
  <div class="container" aria-live="polite">
    <header>
      <h1>TVL Rental – Overdrachtsformulier</h1>
      <p class="subtitle">Vul in, controleer de lijst, teken & download de PDF.</p>
    </header>

    <form id="rentalForm" autocomplete="off" novalidate>
      <!-- Huurder & project -->
      <section>
        <h2>Huurder & Project</h2>
        <div class="grid">
          <label>Naam huurder*<input type="text" name="renterName" required autocomplete="name" /></label>
          <label>Bedrijf<input type="text" name="company" autocomplete="organization" /></label>
          <label>E-mail*<input type="email" name="email" required autocomplete="email" /></label>
          <label>Telefoon<input type="tel" name="phone" autocomplete="tel" /></label>
          <label>Projectnaam*<input type="text" name="project" required /></label>
          <label>PO / Referentie<input type="text" name="po" /></label>
        </div>
      </section>

      <!-- Periode -->
      <section>
        <h2>Periode</h2>
        <div class="grid">
          <label for="pickupDateTime">Ophaal datum / tijd*</label>
          <input type="text" name="pickup" id="pickupDateTime" required inputmode="numeric" />

          <label for="returnDateTime">Retour datum / tijd*</label>
          <input type="text" name="return" id="returnDateTime" required inputmode="numeric" />

          <!-- Ophalen -->
          <label for="pickupMode">Locatie ophalen</label>
          <select id="pickupMode">
            <option value="office" selected>Beek en Donk (Donkersvoorstestraat 3)</option>
            <option value="delivery">Brengen (adres invullen)</option>
          </select>

          <div id="pickupDeliveryWrap" class="span-2 hidden">
            <label for="pickupDeliveryInput">Adres voor brengen (ophalen)</label>
            <input type="text" id="pickupDeliveryInput" placeholder="Straat + nr, plaats" disabled />
          </div>

          <input type="hidden" name="pickupLocation" id="pickupLocation"
                 value="Beek en Donk (Donkersvoorstestraat 3)" />

          <!-- Retour -->
          <label for="returnMode">Locatie retour</label>
          <select id="returnMode">
            <option value="office" selected>Beek en Donk (Donkersvoorstestraat 3)</option>
            <option value="delivery">Brengen (adres invullen)</option>
          </select>

          <div id="returnDeliveryWrap" class="span-2 hidden">
            <label for="returnDeliveryInput">Adres voor brengen (retour)</label>
            <input type="text" id="returnDeliveryInput" placeholder="Straat + nr, plaats" disabled />
          </div>

          <input type="hidden" name="returnLocation" id="returnLocation"
                 value="Beek en Donk (Donkersvoorstestraat 3)" />
        </div>
      </section>

      <!-- Algemene voorwaarden -->
      <section>
        <h2>Algemene voorwaarden</h2>
        <p>
          Lees de
          <a id="termsLink" href="AV.pdf" target="_blank" rel="noopener">Algemene Voorwaarden</a>
          zorgvuldig.
        </p>
        <label class="checkbox">
          <input type="checkbox" id="acceptTerms" required />
          <span>Ik heb de algemene voorwaarden gelezen en ga akkoord*</span>
        </label>
      </section>

      <!-- Gearlijst -->
      <section>
        <h2>Gear-lijst</h2>

        <details class="hint">
          <summary>CSV import (optioneel)</summary>
          <p>Upload een CSV met kolommen: <strong>Item, Serial, Qty, Condition</strong>.</p>
          <input type="file" id="csvInput" accept=".csv" />
        </details>

        <div class="items">
          <table id="itemsTable">
            <thead>
              <tr>
                <th>Item</th>
                <th>Serial</th>
                <th>Qty</th>
                <th>Condition</th>
                <th aria-label="Verwijderen kolom"></th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>

          <div class="row add" role="group" aria-label="Item toevoegen">
            <input type="text" id="addItem" placeholder="Item" />
            <input type="text" id="addSerial" placeholder="Serial / ID" />
            <input type="number" id="addQty" placeholder="Qty" min="1" value="1" />
            <input type="text" id="addCondition" placeholder="Condition (bijv. ‘netjes’)" />
            <button type="button" id="btnAdd" class="secondary">Toevoegen</button>
          </div>
        </div>
      </section>

      <!-- Handtekening -->
      <section>
        <h2>Handtekening</h2>
        <p>
          Ondergetekende bevestigt dat alle bovengenoemde items in goede orde zijn ontvangen
          en akkoord gaat met de Algemene Voorwaarden.
        </p>
        <div class="sig-wrap">
          <canvas id="signaturePad" width="700" height="220" aria-label="Handtekening pad"></canvas>
          <div class="sig-actions">
            <button type="button" id="btnClearSig" class="secondary">Wissen</button>
          </div>
        </div>
      </section>

      <!-- Submit -->
      <section class="actions">
        <button type="submit" id="btnGenerate" class="primary">Genereer PDF</button>
      </section>
    </form>

    <footer>
      <small>© <span id="year"></span> TVL Rental – Interne link, niet doorzoekbaar.</small>
    </footer>
  </div>
</body>
</html>
